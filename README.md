# Project IaC

Infrastructure-as-Code for SberCloud (ru-moscow-1). It provisions networking (VPC, subnet, security groups), a Kubernetes cluster (CCE) with node pools, PostgreSQL instances, and deploys Jenkins, Jira, and Bitbucket via Helm.

## Structure

- terraform/
  - dev/: Development environment (cluster, DB, storage, apps)
  - prod/: Production environment (cluster, DB, storage, apps)
  - terraform.tfvars.example: Sample variables file to copy per environment

## Prerequisites

- Terraform installed
- SberCloud account with Access Key/Secret Key
- S3-compatible bucket in SberCloud OBS for Terraform remote state (default name: `terraformbucket`, region: `ru-moscow-1`). Create it beforehand or adjust `backend.tf` in each env.

## Quick Start

1) Pick an environment and change directory:
   - `cd terraform/dev` or `cd terraform/prod`
2) Copy and edit variables:
   - `cp ../terraform.tfvars.example ./terraform.tfvars`
   - Fill in `access_key`, `secret_key`, and the appropriate DB password for the env.
3) Export backend credentials for OBS (used by the Terraform S3 backend):
   - `export AWS_ACCESS_KEY_ID=...`
   - `export AWS_SECRET_ACCESS_KEY=...`
4) Initialize and apply:
   - `terraform init`
   - `terraform plan`
   - `terraform apply`

Destroy the environment from the same directory with `terraform destroy`.

## Notes

- Do not edit anything under `.terraform/`; it is generated by Terraform.
- Ingress hosts use placeholder domains (e.g., `dev-*.company.local`, `*.company.com`). Update to match your DNS.
- Keep secrets in `terraform.tfvars` (ignored by VCS via `.gitignore`).